[{"path":"/articles/Interatrix.html","id":"install-and-launch-interatrix","dir":"Articles","previous_headings":"","what":"Install and launch Interatrix","title":"The Interatrix package","text":"Interatrix package developped R software whose sources available https://cran.r-project.org/. R software must installed way graphical interfaces can run appropriate packages later installed. Windows Mac OS, automatically computed R software installed. Linux, two libraries tcl tk must installed R must installed using –-tcltk option (see R Installation Administration manual CRAN). R installed, package Interatrix dependencies tcltk, tkrplot tools must installed using command install.packages() R session. also need install doParallel foreach plan use parallel computing (see Section 5). launch Interatrix R session, package must loaded using library(Interatrix). two methods previously cited can used either graphical interface command lines.","code":""},{"path":"/articles/Interatrix.html","id":"initial-installation","dir":"Articles","previous_headings":"","what":"Initial installation","title":"The Interatrix package","text":"Interatrix package developped R software whose sources available https://cran.r-project.org/. R software must installed way graphical interfaces can run appropriate packages later installed. Windows Mac OS, automatically computed R software installed. Linux, two libraries tcl tk must installed R must installed using –-tcltk option (see R Installation Administration manual CRAN). R installed, package Interatrix dependencies tcltk, tkrplot tools must installed using command install.packages() R session. also need install doParallel foreach plan use parallel computing (see Section 5).","code":""},{"path":"/articles/Interatrix.html","id":"start-with-interatrix","dir":"Articles","previous_headings":"","what":"Start with Interatrix","title":"The Interatrix package","text":"launch Interatrix R session, package must loaded using library(Interatrix). two methods previously cited can used either graphical interface command lines.","code":""},{"path":"/articles/Interatrix.html","id":"sec-data","dir":"Articles","previous_headings":"","what":"Data","title":"The Interatrix package","text":"use example, Interatrix package holds data set 100 individual hosts tested two parasites containing missing data. made 5 randomly generated host risk factors: 2 quantitative (F2 F4, sampled standard normal distribution) 3 qualitative (F1, F3 AGE, among AGE gives host age classes) 2 serological statuses (Parasite1 Parasite2, individuals independent 0.5 probability seropositive parasite). data dataInteratrix.rda R binary file. using data set, input data must data frame including data host individuals tested studied parasites, observed values risk factors serological statuses columns host individuals rows. extension data file must txt (data separated tabulations variables’ name first row), csv (data separated comma variables’ name first row), rda, Rda, rdata Rdata. Missing data allowed individuals least one missing data omitted model. Missing data must indicated NA. Qualitative variables must defined factors R (see .factor() function). mainly needed explicit functions used. Binary variables must defined modalities 0 1.","code":""},{"path":"/articles/Interatrix.html","id":"using-the-graphical-interface","dir":"Articles","previous_headings":"","what":"Using the graphical interface","title":"The Interatrix package","text":"Use InteratrixGUI() function start graphical interface. Dialog boxes lead step step. first step, must choose one two methods available Interatrix package validate choice window like shown Figure 1. Figure 1: Dialog window choose one two methods , must indicate location file containing data analyse. want use example data set (dataInteratrix.rda), go folder data Interatrix package. graphical interface depends selected method. window like Figure 2 Figure 3 appear first second method chosen, respectively. Figure 2: Dialog window appearing corrected chi2 method applied test data set Figure 3: Dialog window appearing corrected chi2 accounting also cumulative effect age applied test data set cases, must designate variables must defined factors two variables serological statuses (software automatically convert variables factors). Moreover, model formula (.e., symbolic description model risk factors) number wanted bootstraps (500 default) must filled. second method complex needs parameters. must define antibodies’ disappearance rate parasite, select age class variable define mortality rate age class (values must separated ‘;’, e.g., 0.2;0.2;0.2) bounds classes (values must separated ‘;’, e.g., 0;1;2;10). must indicate directory results saved name format graph created. graph can eps, pdf, png jpeg file. Depending size data, model complexity number simulations, calculations may take time waiting window (Figure 4) may appear. end simulations, results stored chosen directory summary printed R console. Figure 4: Waiting message using second method, parallel computing proposed speed simulations (see Section 5).","code":""},{"path":"/articles/Interatrix.html","id":"through-command-lines","dir":"Articles","previous_headings":"","what":"Through command lines","title":"The Interatrix package","text":"using explicit functions, data must loaded thanks function read.table() (txt file), read.csv() (csv file) load() (R binary file). mentionned previously, qualitative variables must defined factors (see .factor() function). two functions, one method: chi2Corr (accounting risk factors) chi2CorrAge (accounting risk factors cumulative effect age). chi2Corr function written: chi2Corr(formula, data.obs, namepara1, namepara2, nsimu) takes parameters: formula (string characters), data set (data frame formatted indicated Section 2), name variables corresponding serological statuses two parasites (two strings characters) number simulations (integer). chi2CorrAge function written: chi2CorrAge(formula, data.obs, namepara1, namepara2, nameage, w1, w2, mort, , nsimu, nbcore = 3) takes parameters: formula (string characters), data set (data frame formatted indicated Section 2), name variables corresponding serological statuses two parasites (two strings characters), name age variable (string characters), antibodies’ disappearance rate parasite (two real numbers 0 1), host mortality rate within age class (vector real numbers 0 et 1, one value per age class, separated ‘,’, e.g., c(0.2, 0.2, 0.2)), bounds age classes (vector integers many values age classes minus one, separated ‘,’, e.g., c(0, 1, 2, 10)), number simulations (integer) number cores available set parallel computing (3 default; see next paragraph).","code":""},{"path":"/articles/Interatrix.html","id":"sec-parallel","dir":"Articles","previous_headings":"","what":"Parallel computing","title":"The Interatrix package","text":"complex solve takes longer run, recommand use parallel computing optimize calculations using second method. requires two R packages: doParallel foreach. must installed loaded Interatrix loaded. graphical software version, intermediate dialog window (Figure 5) proposes parallelize calculations. software detects automatically number cores available set parallel computing. Figure 5: Dialog window parallel computing Via command lines, user can define optimal number cores allocated simulations (parameter nbcore).","code":""},{"path":"/articles/Interatrix.html","id":"example-with-datainteratrix-rda-using-the-graphical-interface","dir":"Articles","previous_headings":"","what":"Example with dataInteratrix.rda using the graphical interface","title":"The Interatrix package","text":"Parameters taken example: formula = F1+F2*F3+F4 data.obs = dataInteratrix namepara1 = Parasite1 namepara2 = Parasite2 nsimu = 1000 object named simu_chi2corr created printed R console. list several statistics resulting simulations reachable $.  new experience run parameters, dispersion coefficient (simu_chi2corr$dispcoeff) two p-values (simu_chi2corr$pval1 simu_chi2corr$pval2) may different close result bootstrapped simulations. expected frequencies (simu_chi2corr$tab.th) frequencies hosts combination serological statuses expected independence hypothesis considering risk factors. calculated bootstrapped data. Note two p-values printed consol; defined Hellard et al. (2012). example, test significant; observed corrected chi-square within bootstrapped distribution (red star Figure 6). conclusion proportion doubly positive hosts can explained without invoking interaction two parasites. Figure 6: Distribution 1000 bootstrapped corrected chi-square values using first method value observed corrected chi-square (red star) Parameters taken example: formula = F1+F2+AGE data.obs = dataInteratrix namepara1 = Parasite1 namepara2 = Parasite2 nameage = AGE w1 = 0 w2 = 0 mort = 0.2;0.2;0.2 = 0;1;2;10 nsimu = 1000 nbcore = 3 object named simu_chi2corrage created printed R console. list several statistics resulting simulations reachable $.  new experience run parameters, p-value (simu_chi2corrage$pval) may different close results bootstrapped simulations. expected frequencies (simu_chi2corrage$tab.th) frequencies hosts combination serological statuses expected independence hypothesis, considering risk factors cumulative effect age. calculated bootstrapped data. example, test significant observed corrected chi-square whithin bootstrapped distribution (red star Figure 7). proportion doubly positive hosts can explained identified risk factors cumulative effect age. Figure 7: Distribution 1000 bootstrapped corrected chi-square values using second method value observed corrected chi-square (red star)","code":""},{"path":"/articles/Interatrix.html","id":"first-method-chi-square-corrected-for-risks-factors-chi2corr-function","dir":"Articles","previous_headings":"","what":"First method: chi-square corrected for risks factors (chi2Corr function)","title":"The Interatrix package","text":"Parameters taken example: formula = F1+F2*F3+F4 data.obs = dataInteratrix namepara1 = Parasite1 namepara2 = Parasite2 nsimu = 1000 object named simu_chi2corr created printed R console. list several statistics resulting simulations reachable $.  new experience run parameters, dispersion coefficient (simu_chi2corr$dispcoeff) two p-values (simu_chi2corr$pval1 simu_chi2corr$pval2) may different close result bootstrapped simulations. expected frequencies (simu_chi2corr$tab.th) frequencies hosts combination serological statuses expected independence hypothesis considering risk factors. calculated bootstrapped data. Note two p-values printed consol; defined Hellard et al. (2012). example, test significant; observed corrected chi-square within bootstrapped distribution (red star Figure 6). conclusion proportion doubly positive hosts can explained without invoking interaction two parasites. Figure 6: Distribution 1000 bootstrapped corrected chi-square values using first method value observed corrected chi-square (red star)","code":""},{"path":"/articles/Interatrix.html","id":"second-method-chi-square-corrected-for-risks-factors-and-for-the-cumulative-effect-of-age-chi2corrage-function","dir":"Articles","previous_headings":"","what":"Second method: chi-square corrected for risks factors and for the cumulative effect of age (chi2CorrAge function)","title":"The Interatrix package","text":"Parameters taken example: formula = F1+F2+AGE data.obs = dataInteratrix namepara1 = Parasite1 namepara2 = Parasite2 nameage = AGE w1 = 0 w2 = 0 mort = 0.2;0.2;0.2 = 0;1;2;10 nsimu = 1000 nbcore = 3 object named simu_chi2corrage created printed R console. list several statistics resulting simulations reachable $.  new experience run parameters, p-value (simu_chi2corrage$pval) may different close results bootstrapped simulations. expected frequencies (simu_chi2corrage$tab.th) frequencies hosts combination serological statuses expected independence hypothesis, considering risk factors cumulative effect age. calculated bootstrapped data. example, test significant observed corrected chi-square whithin bootstrapped distribution (red star Figure 7). proportion doubly positive hosts can explained identified risk factors cumulative effect age. Figure 7: Distribution 1000 bootstrapped corrected chi-square values using second method value observed corrected chi-square (red star)","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Aurélie Siberchicot. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Siberchicot , Hellard E, Pontier D, Fouchet D, Sauvage F (2025). Interatrix: Compute Chi-Square Measures Corrections. R package version 1.1.5, https://github.com/lbbe-software/Interatrix.","code":"@Manual{,   title = {Interatrix: Compute Chi-Square Measures with Corrections},   author = {Aurélie Siberchicot and Eléonore Hellard and Dominique Pontier and David Fouchet and Franck Sauvage},   year = {2025},   note = {R package version 1.1.5},   url = {https://github.com/lbbe-software/Interatrix}, }"},{"path":"/index.html","id":"interatrix","dir":"","previous_headings":"","what":"Compute Chi-Square Measures with Corrections","title":"Compute Chi-Square Measures with Corrections","text":"Compute Chi-Square Measures Corrections","code":""},{"path":"/reference/Interatrix-internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal functions for the Interatrix package. — Interatrix-internal","title":"Internal functions for the Interatrix package. — Interatrix-internal","text":"Internal functions Interatrix package.","code":""},{"path":"/reference/Interatrix-internal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal functions for the Interatrix package. — Interatrix-internal","text":"list2ascii(x,file = paste(deparse(substitute(x)), \".txt\", sep = \"\")) ## internal functions chi2Corr() chi2CorrGUI() obsdata_chi2corr(formula, data, name1, name2) chi2corrboot(data, formula, sero1, sero2) simudata_chi2corr(formula, data, name1, name2, nbsimu, pvir1, pvir2, chi2corrobs) ## internal functions chi2CorrAge() chi2CorrAgeGUI() SensTransMatrix(para, listmodel, rate, agenum, ) EstimParam(paranum, rate, listmodel, agenum, v0, tol = 0.00000001, maxit = 50000, , mort) ModelClass(para, formula, data, agemax, nameage) calcInfectProba(data, formula, namepara1, namepara2, nameage, w1, w2, mort, , v0para1, v0para2) obsdata_chi2corrage(formula, data, name1, name2, nameage, w1, w2, mort, , v0para1, v0para2) simudata_chi2corrage(formula, data, name1, name2, nameage, w1, w2, mort, , v0para1, v0para2, matprobainfect)","code":""},{"path":"/reference/InteratrixGUI.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to start the graphical interface — InteratrixGUI","title":"Function to start the graphical interface — InteratrixGUI","text":"function opens graphical interface helps step step compute corrected chi-square tests.","code":""},{"path":"/reference/InteratrixGUI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to start the graphical interface — InteratrixGUI","text":"","code":"InteratrixGUI()"},{"path":"/reference/InteratrixGUI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to start the graphical interface — InteratrixGUI","text":"first interactive graphical interface opened choose two methods. parameters defined user, simulation results printed R console, saved file plotted histogram.","code":""},{"path":"/reference/chi2Corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Searches for parasite interactions taking risk factors into account. — chi2Corr","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"function implements method correct shared risk factors search interactions. provides observed chi-square value, measure association two parasites, simulates bootstrapped data taking risk factors account.","code":""},{"path":"/reference/chi2Corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"","code":"chi2Corr(formula, data.obs, namepara1, namepara2, nsimu)"},{"path":"/reference/chi2Corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"formula string characters indicating symbolic description model shared risk factors fitted without response variable data.obs name data set used namepara1 name column giving status first parasite namepara2 name column giving status second parasite nsimu integer indicating number repetitions bootstrap simulation","code":""},{"path":"/reference/chi2Corr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"value returned list containing: formula model fitted without response variable time duration seconds simulations chi2.corr.obs Pearson's chi2 statistic calculated data.obs dispcoeff estimated coefficient - (-) dispersion, defined mean bootstrapped values corrected chi-square. pval1 p-value corrected chi-square test null hypothesis independence two parasites.     pval1 estimated assuming corrected chi-square proportional chi-square one degree freedom. pval2 p-value corrected chi-square test null hypothesis independence two parasites.     pval2 given proportion bootstrapped corrected chi-squares smaller observed value (chi2.corr.obs). tab.th expected frequencies, ie. contingency table calculated theoretical (bootstrapped) data tab.obs observed frequencies, ie. contingency table calculated data.obs chi2.corr.sim vector containing nsimu Pearson's chi2 statistics calculated simulated data. distribution bootstrapped corrected chi-squares (histogram) also provided.","code":""},{"path":"/reference/chi2Corr.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"pval2 better pval1 requires running enough simulations, wich may long cases. pval1 allows working smaller numbers simualtions simulation times long.","code":""},{"path":"/reference/chi2Corr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"True versus False Parasite Interactions: Robust Method Take Risk Factors Account Application Feline Viruses. Hellard E., Pontier D., Sauvage F., Poulet H. Fouchet D. (2012). PLoS ONE 7(1): e29618. doi:10.1371/journal.pone.0029618.","code":""},{"path":"/reference/chi2Corr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Searches for parasite interactions taking risk factors into account. — chi2Corr","text":"","code":"if (FALSE) { # \\dontrun{   library(Interatrix)   data(dataInteratrix)   res1 <- chi2Corr(\"F1+F2*F3+F4\", dataInteratrix, \"Parasite1\", \"Parasite2\", 500) } # }"},{"path":"/reference/chi2CorrAge.html","id":null,"dir":"Reference","previous_headings":"","what":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"function implements method correct cumulative effect age potentially confounding risk factors search interactions. provides observed chi-square value, measure association two parasites, simulates bootstrapped data taking risk factors account.","code":""},{"path":"/reference/chi2CorrAge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"","code":"chi2CorrAge(formula, data.obs, namepara1, namepara2, nameage, w1, w2, mort, a,  nsimu, nbcore = 3)"},{"path":"/reference/chi2CorrAge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"formula string characters indicating symbolic description model shared risk factors (including age) fitted without response variable data.obs name data set used namepara1 name column giving status first parasite namepara2 name column giving status second parasite nameage column name age classes w1 real number 0 1 indicating antibodies' disappearance rate first studied parasite w2 real number 0 1 indicating antibodies' disappearance rate second studied parasite mort vector real numbers 0 1 giving mortality rates age classes vector integers giving bounds age classes nsimu integer indicating number repetitions bootstrap simulation nbcore integer indicating number cores available computer set parallel calculation","code":""},{"path":"/reference/chi2CorrAge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"value returned list containing: formula model fitted without response variable time duration seconds simulations nbcore number cores used parallel simulations chi2.corr.obs Pearson's chi2 statistic calculated data.obs pval p-value corrected chi-square test null hypothesis independence two parasites.     pval given proportion bootstrapped corrected chi-squares smaller observed value (chi2.corr.obs). tab.th expected frequencies, ie. contingency table calculated theoretical (bootstrapped) data tab.obs observed frequencies, ie. contingency table calculated data.obs chi2.corr.sim vector containing nsimu Pearson's chi2 statistics calculated simulated data. distribution bootstrapped corrected chi-squares (histogram) also provided.","code":""},{"path":"/reference/chi2CorrAge.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"Unknown age health disorders: method account cumulative effect application feline viruses interactions. Hellard E., Pontier D., Siberchicot ., Sauvage F. Fouchet D. (2015). Epidemics 11: 48-55. doi:10.1016/j.epidem.2015.02.004.","code":""},{"path":"/reference/chi2CorrAge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Searches for parasite interactions taking the cumulative effect of age and other risk factors into account. — chi2CorrAge","text":"","code":"if (FALSE) { # \\dontrun{   library(Interatrix)   data(dataInteratrix)   res2 <- chi2CorrAge(\"F1+F2+AGE\", dataInteratrix, \"Parasite1\", \"Parasite2\", \"AGE\", w1 = 0,      w2 = 0, mort = c(0.2, 0.2, 0.2), a = c(0, 1, 2, 10), nsimu = 500, nbcore = 2) } # }"},{"path":"/reference/dataInteratrix.html","id":null,"dir":"Reference","previous_headings":"","what":"A generated data set for test — dataInteratrix","title":"A generated data set for test — dataInteratrix","text":"generated data set provided test Interatrix package.","code":""},{"path":"/reference/dataInteratrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A generated data set for test — dataInteratrix","text":"","code":"data(dataInteratrix)"},{"path":"/reference/dataInteratrix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A generated data set for test — dataInteratrix","text":"data frame 100 observations following variables: F1 numeric vector containing factor three modalities F2 numeric vector containing continuous variable F3 numeric vector containing factor two modalities F4 numeric vector containing continuous variable Parasite1 numeric vector containing serological status first parasite Parasite2 numeric vector containing serological status second parasite AGE numeric vector containing factor three modalities indicating age classes","code":""},{"path":"/reference/dataInteratrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A generated data set for test — dataInteratrix","text":"","code":"data(dataInteratrix)"}]
